// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

enum Role {
  USER
  ADMIN
}

model User {
  id        Int      @id @default(autoincrement())
  email     String   @unique
  name      String?
  password  String
  role      Role     @default(USER)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  createdChallenges Challenge[] @relation("Challenger")
  acceptedChallenges Challenge[] @relation("Solver")
}

model Challenge {
  id           Int      @id @default(autoincrement())
  title        String
  category     String
  // imageUrl     String // Dihapus dari sini
  description  String
  reward       Int
  deadline     DateTime
  status       String   @default("Open")
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt

  challengerId Int
  challenger   User     @relation("Challenger", fields: [challengerId], references: [id], onDelete: Cascade)

  solverId     Int?
  solver       User?    @relation("Solver", fields: [solverId], references: [id], onDelete: SetNull)

  // Relasi baru: Satu tantangan punya banyak gambar
  images       ChallengeImage[]
}

// MODEL BARU UNTUK MENYIMPAN GAMBAR
model ChallengeImage {
  id          Int      @id @default(autoincrement())
  url         String   // Path ke file gambar
  createdAt   DateTime @default(now())
  challengeId Int
  challenge   Challenge @relation(fields: [challengeId], references: [id], onDelete: Cascade)
}
